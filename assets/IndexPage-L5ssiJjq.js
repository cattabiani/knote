import{c as w,g as k,i as y,e as u,l as I,b as x,a as g,h as C,y as v,t as _,u as P,v as D,z as T,A as E,B as $}from"./index-CT4itnAx.js";import{h as b}from"./render-dChl5Uk-.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";const S=w({name:"QPage",props:{padding:Boolean,styleFn:Function},setup(e,{slots:t}){const{proxy:{$q:o}}=k(),n=y(I,u);if(n===u)return console.error("QPage needs to be a deep child of QLayout"),u;if(y(x,u)===u)return console.error("QPage needs to be child of QPageContainer"),u;const s=g(()=>{const h=(n.header.space===!0?n.header.size:0)+(n.footer.space===!0?n.footer.size:0);if(typeof e.styleFn=="function"){const f=n.isContainer.value===!0?n.containerHeight.value:o.screen.height;return e.styleFn(h,f)}return{minHeight:n.isContainer.value===!0?n.containerHeight.value-h+"px":o.screen.height===0?h!==0?`calc(100vh - ${h}px)`:"100vh":o.screen.height-h+"px"}}),p=g(()=>`q-page${e.padding===!0?" q-layout-padding":""}`);return()=>C("main",{class:p.value,style:s.value},b(t.default))}}),d=[];for(let e=0;e<256;++e)d.push((e+256).toString(16).slice(1));function U(e,t=0){return(d[e[t+0]]+d[e[t+1]]+d[e[t+2]]+d[e[t+3]]+"-"+d[e[t+4]]+d[e[t+5]]+"-"+d[e[t+6]]+d[e[t+7]]+"-"+d[e[t+8]]+d[e[t+9]]+"-"+d[e[t+10]]+d[e[t+11]]+d[e[t+12]]+d[e[t+13]]+d[e[t+14]]+d[e[t+15]]).toLowerCase()}let m;const B=new Uint8Array(16);function F(){if(!m){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");m=crypto.getRandomValues.bind(crypto)}return m(B)}const A=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),N={randomUUID:A};function Q(e,t,o){e=e||{};const n=e.random??e.rng?.()??F();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,U(n)}function H(e,t,o){return N.randomUUID&&!e?N.randomUUID():Q(e)}const a={make(e="",t=""){return t||(t=H()),{id:t,parentId:null,title:e,done:!1,children:[]}},addChild(e,t,o=-1){o<0||o>e.children.length?e.children.push(t.id):e.children.splice(o,0,t.id),t.parentId=e.id},removeChild(e,t,o=!0){const n=e.children.findIndex(r=>r===t.id);if(n===-1)throw new Error(`Node ${t.id} not found in parent ${e.id}'s children`);return e.children.splice(n,1),o&&(t.parentId=null),n},swapChildren(e,t,o){t<0||o<0||t>=e.children.length||o>=e.children.length||([e.children[t],e.children[o]]=[e.children[o],e.children[t]])},flipDone(e){const t=e.done;return e.done=!e.done,t},editTitle(e,t){const o=e.title;return e.title=t,o}},i={makeAddNewNode(e,t){return{type:"addNewNode",title:e,parentId:t}},makeRemoveNode(e){return{type:"removeNode",nodeId:e}},makeEditTitle(e,t){return{type:"editTitle",newTitle:e,nodeId:t}},makeFlipDone(e){return{type:"flipDone",nodeId:e}},makeMoveNode(e,t,o){return{type:"moveNode",nodeId:e,newParentId:t,newIndex:o}},makeSwapChildren(e,t,o){return{type:"swapChildren",nodeId:e,idx0:t,idx1:o}},makeRestoreNodes(e,t){return{type:"restoreNodes",nodes:e,rootIndex:t}}},l={make(){return{root:a.make("root","root")}},has(e,t){return t in e},getNode(e,t){const o=e[t];return o||e.root},getNodeByTitle(e,t){for(const[o]of Object.values(e))if(o.title===t)return o;return null},*walk(e,t){const o=this.getNode(e,t);for(let n=o.children.length-1;n>=0;n--)yield*this.walk(e,o.children[n]);yield o},addNode(e,t){if(e[t.id])throw new Error(`Node with id ${t.id} already exists`);return e[t.id]=t,t},addNewNode(e,t,o){const n=this.getNode(e,o),r=a.make(t);return a.addChild(n,r),e[r.id]=r,r},restoreNodes(e,t,o){if(!t.length)return;const n=t.pop(),r=this.getNode(e,n.parentId);a.addChild(r,n,o),this.addNode(e,n);let s;for(;s=t.pop();)this.addNode(e,s);return n},removeNode(e,t){const o=this.getNode(e,t);if(o.id==="root")throw new Error("Cannot remove root node");const n=this.getNode(e,o.parentId),r=a.removeChild(n,o,!1),s=Array.from(this.walk(e,t));for(const p of s)delete e[p.id];return{deletedNodes:s,rootIndex:r}},moveNode(e,t,o,n=-1){const r=this.getNode(e,t),s=this.getNode(e,r.parentId),p=this.getNode(e,o),h=a.removeChild(s,r);return a.addChild(p,r,n),{oldParent:s,oldIndex:h}},swapChildren(e,t,o,n){const r=this.getNode(e,t);a.swapChildren(r,o,n)},flipDone(e,t){if(t==="root")throw new Error("Cannot flip done state of root node");const o=this.getNode(e,t);a.flipDone(o)},editTitle(e,t,o){if(t==="root")throw new Error("Cannot edit title of root node");const n=this.getNode(e,t);return a.editTitle(n,o)},currentPath(e,t){const o=this.getNode(e,t);if(o.id==="root")return"/";const n=[];let r=o;for(;r&&r.id!=="root";)n.push(r.title||"(untitled)"),r=this.getNode(e,r.parentId);return n.push(""),n.reverse().join("/")},applyEvent(e,t){switch(t.type){case"addNewNode":{const o=this.addNewNode(e,t.title,t.parentId);return i.makeRemoveNode(o.id)}case"removeNode":{const{deletedNodes:o,rootIndex:n}=this.removeNode(e,t.nodeId);return i.makeRestoreNodes(o,n)}case"restoreNodes":{const o=this.restoreNodes(e,t.nodes,t.rootIndex);return i.makeRemoveNode(o.id)}case"editTitle":{const o=this.editTitle(e,t.nodeId,t.newTitle);return t.newTitle=o,t}case"moveNode":{const{oldParent:o,oldIndex:n}=this.moveNode(e,t.nodeId,t.newParentId,t.newIndex);return i.makeMoveNode(t.nodeId,o.id,n)}case"swapChildren":return this.swapChildren(e,t.nodeId,t.idx0,t.idx1),i.makeSwapChildren(t.nodeId,t.idx1,t.idx0);case"flipDone":return this.flipDone(e,t.nodeId),t;default:throw new Error(`Unknown event type: ${t.type}`)}},checkIntegrity(e){const t=new Set;for(const o of this.walk(e,"root")){if(t.has(o.id))throw new Error(`Integrity error: cycle detected at ${o.id}`);t.add(o.id);for(const n of o.children)if(this.getNode(e,n).parentId!==o.id)throw new Error(`Integrity error: child ${n} parentId mismatch`)}for(const o in e)if(!t.has(o))throw new Error(`Integrity error: orphan node ${o}`)}},c={make(e){return{head:0,len:0,idx:0,stack:new Array(e).fill(null),max:e}},_at(e,t){return(e.head+t)%e.max},push(e,t,o){e.len=e.idx,e.stack[this._at(e,e.len)]=t,e.len===e.max?e.head=this._at(e,1):++e.len,e.idx=e.len-1,this.redo(e,o)},redo(e,t){if(e.idx>=e.len)return;const o=this._at(e,e.idx);try{e.stack[o]=l.applyEvent(t,e.stack[o]),++e.idx}catch(n){throw--e.len,e.idx=e.len,n}},undo(e,t){if(e.idx<=0)return;--e.idx;const o=this._at(e,e.idx);try{e.stack[o]=l.applyEvent(t,e.stack[o])}catch(n){const r=this._at(e,e.len);throw o<r?e.stack.copyWithin(o,o+1,e.len):(e.stack.copyWithin(o,o+1,e.stack.length),e.stack[e.stack.length-1]=e.stack[0],e.stack.copyWithin(0,1,r)),--e.len,n}}},V=v("mainStore",{state:()=>({data:l.make(),currentPathId:"root",history:c.make(50),showDone:!1}),getters:{currentNode(){return l.getNode(this.data,this.currentPathId)},currentChildren(){const e=this.currentNode;return e?e.children.map(t=>this.getNode(t)).filter(Boolean):[]},currentPath(){return l.currentPath(this.data,this.currentPathId)}},actions:{addNode(e=""){const t=i.makeAddNewNode(e,this.currentPathId);c.push(this.history,t,this.data)},editNodeTitle(e,t){const o=i.makeEditTitle(e,t);c.push(this.history,o,this.data)},swapChildren(e,t){const o=this.currentNode,n=i.makeSwapChildren(o.id,e,t);c.push(this.history,n,this.data)},moveNode(e,t){const o=i.makeMoveNode(e,t,-1);c.push(this.history,o,this.data)},getNode(e){return l.getNode(this.data,e)},removeNode(e){const t=i.makeRemoveNode(e);return c.push(this.history,t,this.data),!l.has(this.data,e)},flipDone(e){const t=i.makeFlipDone(e);c.push(this.history,t,this.data)},undo(){c.undo(this.history,this.data)},redo(){c.redo(this.history,this.data)},goTo(e){return l.has(this.data,e)?(this.currentPathId=e,!0):!1},goBack(){return this.goTo(this.currentNode.parentId)}},persist:{key:"sessionDataKnote",pick:["data","currentPathId","history","showDone"]}}),j={__name:"IndexPage",setup(e){const t=V();return(o,n)=>(P(),_(S,{class:"flex flex-center"},{default:D(()=>[T(" hello there "+E($(t).data),1)]),_:1}))}},M=R(j,[["__scopeId","data-v-65ce2495"]]);export{M as default};
